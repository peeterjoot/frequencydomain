%
% Copyright Â© 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\section{Geometric Algebra form of Maxwell's equations in the frequency domain}

Presuming time dependence of all fields and sources of the form

\begin{dmath}\label{eqn:frequencydomainCore:20}
\calT(\Bx, t) = \Real( T(\Bx) e^{j \omega t} ),
\end{dmath}

the time harmonic form of Maxwell's equations are

\begin{dmath}\label{eqn:frequencydomainCore:40}
\begin{aligned}
\spacegrad \cross \BE &= -j \omega \BB \\
\spacegrad \cdot \BD &= \rho \\
\spacegrad \cross \BH &= \BJ + j \omega \BD \\
\spacegrad \cdot \BB &= 0.
\end{aligned}
\end{dmath}

In linear simple media, with \( \BD = \epsilon \BE \), and \( \BB = \mu \BH \), the Geometric Algebra identity

\begin{dmath}\label{eqn:frequencydomainCore:120}
\Bx \By = \Bx \cdot \By + I \Bx \cross \By,
\end{dmath}

%where \( I = \Be_1 \Be_2 \Be_3 \) is the \R{3} pseudoscalar, allows
can be used to reduce Maxwell's equations to a pair of coupled multivector equations

\begin{subequations}
\label{eqn:frequencydomainCore:60}
\begin{dmath}\label{eqn:frequencydomainCore:561}
\spacegrad \BE     = -j \omega \mu (I \BH) + \rho/\epsilon
\end{dmath}
\begin{dmath}\label{eqn:frequencydomainCore:560}
\spacegrad (I \BH) = -\BJ - j \omega \epsilon \BE.
\end{dmath}
\end{subequations}

In the source free case, these can be decoupled trivially by multiplying both equations by the gradient

\begin{dmath}\label{eqn:frequencyDomainCore:581}
\begin{aligned}
\spacegrad^2 \BE     &= -j \omega \mu \spacegrad (I \BH)
\spacegrad^2 (I \BH) &= - j \omega \epsilon \spacegrad \BE.
\end{aligned}
\end{dmath}

After substitution of \cref{eqn:frequencydomainCore:60} these are

%\begin{dmath}\label{eqn:frequencyDomainCore:601}
\boxedEquation{eqn:frequencyDomainCore:621}{
\begin{aligned}
\spacegrad^2 \BE     &= - \omega^2 \epsilon \mu \BE \\
\spacegrad^2 (I \BH) &= -  \omega^2 \epsilon \mu I \BH.
\end{aligned}
}
%\end{dmath}

These can now be solved separately, subject to the constraints imposed by the first order system \cref{eqn:frequencydomainCore:60}.

Geometric algebra allows for an alternate way of dealing with the coupled equations, allowing both equations to be assembled into a single ffirst order system.  How to perform that assembly is made more clear by first casting \cref{eqn:frequencydomainCore:60} into a non-dimensional form

\begin{subequations}
\label{eqn:frequencydomainCore:641}
\begin{dmath}\label{eqn:frequencydomainCore:661}
\spacegrad (\sqrt{\epsilon} \BE)     = -j \omega \sqrt{\epsilon\mu} (\sqrt{\mu} I \BH) + \rho/\sqrt{\epsilon}
\end{dmath}
\begin{dmath}\label{eqn:frequencydomainCore:681}
\spacegrad (\sqrt{\mu} I \BH) = -\sqrt{\mu} \BJ - j \omega \sqrt{\epsilon\mu} (\sqrt{\epsilon} \BE).
\end{dmath}
\end{subequations}

Since \( \BE \) is a vector and \( I \BH \) is a bivector, either field can be recovered from a linear combination of these fields using vector or bivector grade selection operations.  In particular, summing the non-dimensional equations gives

\begin{dmath}\label{eqn:frequencyDomainCore:701}
\spacegrad \lr{ \sqrt{\epsilon} \BE + \sqrt{\mu} I \BH } = -j \omega \sqrt{\epsilon\mu} \lr{ \sqrt{\epsilon} \BE + \sqrt{\mu} I \BH }
+ \rho/\sqrt{\epsilon} -\sqrt{\mu} \BJ.
\end{dmath}

Here non-dimensional units have been used, which decouple the field equations in terms of a multivector field \( F = \sqrt{\epsilon} \BE + \sqrt{\mu} I \BH \).
In physics the fields are usually described in terms of \( \BE, \BB \), or \( F = \BE + v I \BB \), where \( v = 1/\sqrt{\epsilon\mu} \) is the group velocity found solving for the waves of \cref{eqn:frequencyDomainCore:621}.  In engineering, \( \BE, \BH \) are often taken as the primary fields, so the desired choice of units means the multivector field should be

\begin{dmath}\label{eqn:frequencydomainCore:80}
F = \BE + \eta I \BH,
\end{dmath}

where \( \eta = \sqrt{\mu/\epsilon} \) is the impedance of the media.  The first order decoupled equations for field are therefore

\boxedEquation{eqn:frequencydomainCore:100}{
(\spacegrad + j k) F
=
\rho/\epsilon - \eta \BJ.
}

Here \( k = \omega/v \) is the wave number.
%, and \( v = 1/\sqrt{\mu\epsilon} \) is the group velocity of a wave in the media.  
Observe that there are two complex quantities in the mix \( j = \sqrt{-1} \), and \( I^2 = -1 \), each of which commutes with any of the fields or sources, or the gradient operator.

The reader may wonder why \cref{eqn:frequencydomainCore:661} were added and not subtracted.  This is also possible, and would essentially amount to a different choice of phase for the magnetic field.  Use of addition instead of subtraction is partially just convention, but is also consistent with the conventions used for relativistic treatments of Maxwell's equation in GA.

\makeexample{Extracting the electric and magnetic fields.}{example:frequencydomainCore:1}{

With two complex quantities involved in the field multivector \cref{eqn:frequencydomainCore:80}, it might be unclear how to recover the separate electric and magnetic fields.
While \( F \) is complex with respect to both \( j \) and \( I \), this multivector has two different grades.  Specifically, \( \BE \) is a vector and \( I \BH \) is a bivector, and can both be extracted using grade selection operations.  Suppose for example

\begin{dmath}\label{eqn:frequencydomainCore:460}
\begin{aligned}
\BE &= e_1 e^{-j k z} \\
\BH &= \inv{\eta} e_2 e^{-j k z}
\end{aligned}
\end{dmath}

The composite field is

\begin{equation}\label{eqn:frequencydomainCore:480}
F = (\Be_1 + \Be_3 \Be_1) e^{-j k z}.
\end{equation}

Extracting \( \BE\), and \( \BH \) when desired requires grade 1 and grade 2 selections respectively

\begin{subequations}
\label{eqn:frequencydomainCore:500}
\begin{dmath}\label{eqn:frequencydomainCore:520}
\BE = \gpgradeone{F} = \Be_1 e^{-j k z} \\
\end{dmath}
\begin{dmath}\label{eqn:frequencydomainCore:540}
\BH
= -\frac{I}{\eta} \gpgradetwo{F}
= -\inv{\eta} (\Be_1 \Be_2 \Be_3) \Be_3 \Be_1 e^{-j k z}
= \inv{\eta} \Be_2 e^{-j k z}.
\end{dmath}
\end{subequations}

The key here is that the spatial pseudoscalar, while it satisfies \( I^2 = -1 \) like a complex number, also has a geometric structure and can be distinguished from the scalar complex \( j \) that is used in the phasor construction.
} % example

